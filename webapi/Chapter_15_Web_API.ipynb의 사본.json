{"cells":[{"cell_type":"markdown","metadata":{"id":"WD0wN_R4zgB6"},"source":["# 15장 웹 API"]},{"cell_type":"markdown","metadata":{"id":"QPqWukeZzgB7"},"source":["## 15.1 웹 API의 이해"]},{"cell_type":"markdown","metadata":{"id":"Lq7o5jgTzgB8"},"source":["### 웹 API의 데이터 획득 과정"]},{"cell_type":"markdown","metadata":{"id":"KBN3MQe-zgB8"},"source":["### 웹 API의 인증 방식"]},{"cell_type":"markdown","metadata":{"id":"ZC-dXHWNzgB8"},"source":["### 응답 데이터의 형식 및 처리"]},{"cell_type":"markdown","metadata":{"id":"zYHY6oGgzgB8"},"source":["#### JSON 형식의 데이터 처리"]},{"cell_type":"markdown","metadata":{"id":"UF3wvMlnzgB8"},"source":["**[15장: 458 ~ 459페이지]**"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"BVfpb7KLzgB8","executionInfo":{"status":"ok","timestamp":1702028528923,"user_tz":-540,"elapsed":3,"user":{"displayName":"이석창","userId":"12669722191103790079"}},"outputId":"fefb3c1d-3b43-489f-fb34-eb7d43351b5c"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["dict"]},"metadata":{},"execution_count":1}],"source":["import json\n","\n","python_dict = {\n","    \"이름\": \"홍길동\",\n","    \"나이\": 25,\n","    \"거주지\": \"서울\",\n","    \"신체정보\": {\n","        \"키\": 175.4,\n","        \"몸무게\": 71.2\n","    },\n","    \"취미\": [\n","        \"등산\",\n","        \"자전거타기\",\n","        \"독서\"\n","    ]\n","}\n","type(python_dict)"]},{"cell_type":"markdown","metadata":{"id":"acPv94pgzgB9"},"source":["**[15장: 459페이지]**"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"Z9QNrY5vzgB9","executionInfo":{"status":"ok","timestamp":1702028543552,"user_tz":-540,"elapsed":434,"user":{"displayName":"이석창","userId":"12669722191103790079"}},"outputId":"66403234-13a5-4802-b663-f4eb44594d85"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["str"]},"metadata":{},"execution_count":2}],"source":["json_data = json.dumps(python_dict)\n","type(json_data)"]},{"cell_type":"markdown","metadata":{"id":"T-3jOcztzgB9"},"source":["**[15장: 459페이지]**"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"JE4rNpahzgB9","executionInfo":{"status":"ok","timestamp":1702028545717,"user_tz":-540,"elapsed":5,"user":{"displayName":"이석창","userId":"12669722191103790079"}},"outputId":"08512e6c-5f06-47af-e801-a1d00401c7cf"},"outputs":[{"output_type":"stream","name":"stdout","text":["{\"\\uc774\\ub984\": \"\\ud64d\\uae38\\ub3d9\", \"\\ub098\\uc774\": 25, \"\\uac70\\uc8fc\\uc9c0\": \"\\uc11c\\uc6b8\", \"\\uc2e0\\uccb4\\uc815\\ubcf4\": {\"\\ud0a4\": 175.4, \"\\ubab8\\ubb34\\uac8c\": 71.2}, \"\\ucde8\\ubbf8\": [\"\\ub4f1\\uc0b0\", \"\\uc790\\uc804\\uac70\\ud0c0\\uae30\", \"\\ub3c5\\uc11c\"]}\n"]}],"source":["print(json_data)"]},{"cell_type":"markdown","metadata":{"id":"oVad5VGfzgB9"},"source":["**[15장: 459페이지]**"]},{"cell_type":"code","execution_count":null,"metadata":{"scrolled":true,"colab":{"base_uri":"https://localhost:8080/"},"id":"qeI2jlTOzgB-","executionInfo":{"status":"ok","timestamp":1702028554229,"user_tz":-540,"elapsed":440,"user":{"displayName":"이석창","userId":"12669722191103790079"}},"outputId":"91bcff45-07b8-476a-f4b7-af22c1d19adb"},"outputs":[{"output_type":"stream","name":"stdout","text":["{\n","   \"거주지\": \"서울\",\n","   \"나이\": 25,\n","   \"신체정보\": {\n","      \"몸무게\": 71.2,\n","      \"키\": 175.4\n","   },\n","   \"이름\": \"홍길동\",\n","   \"취미\": [\n","      \"등산\",\n","      \"자전거타기\",\n","      \"독서\"\n","   ]\n","}\n"]}],"source":["json_data = json.dumps(python_dict, indent=3, sort_keys=True, ensure_ascii=False)\n","print(json_data)"]},{"cell_type":"markdown","metadata":{"id":"f3QX11tfzgB-"},"source":["**[15장: 460페이지]**"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"ZS_j2sYQzgB-","executionInfo":{"status":"ok","timestamp":1702028563554,"user_tz":-540,"elapsed":443,"user":{"displayName":"이석창","userId":"12669722191103790079"}},"outputId":"a7e9d555-e0b5-49c0-89b9-c26b153e5530"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["dict"]},"metadata":{},"execution_count":5}],"source":["json_dict = json.loads(json_data)\n","type(json_dict)"]},{"cell_type":"markdown","metadata":{"id":"UQXUkTsszgB-"},"source":["**[15장: 460페이지]**"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"Xt-excZIzgB-","executionInfo":{"status":"ok","timestamp":1702028566575,"user_tz":-540,"elapsed":3,"user":{"displayName":"이석창","userId":"12669722191103790079"}},"outputId":"0d1d81c4-2efe-40d7-d074-070e92484f2e"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["71.2"]},"metadata":{},"execution_count":6}],"source":["json_dict['신체정보']['몸무게']"]},{"cell_type":"markdown","metadata":{"id":"1z4bFoDbzgB-"},"source":["**[15장: 460페이지]**"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"x5pvG44fzgB-","executionInfo":{"status":"ok","timestamp":1702028575956,"user_tz":-540,"elapsed":2,"user":{"displayName":"이석창","userId":"12669722191103790079"}},"outputId":"e7348d0f-f6dd-4b59-ab3a-f28e08c7ec0e"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["['등산', '자전거타기', '독서']"]},"metadata":{},"execution_count":7}],"source":["json_dict['취미']"]},{"cell_type":"markdown","metadata":{"id":"O8arq5OhzgB-"},"source":["**[15장: 461페이지]**"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":36},"id":"uDKzIH4lzgB-","executionInfo":{"status":"ok","timestamp":1702028578354,"user_tz":-540,"elapsed":8,"user":{"displayName":"이석창","userId":"12669722191103790079"}},"outputId":"1cc431d8-5143-40e2-fe0b-a59139a30441"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["'등산'"],"application/vnd.google.colaboratory.intrinsic+json":{"type":"string"}},"metadata":{},"execution_count":8}],"source":["json_dict['취미'][0]"]},{"cell_type":"markdown","metadata":{"id":"qmfupAGczgB-"},"source":["#### XML 형식의 데이터 처리"]},{"cell_type":"markdown","metadata":{"id":"KWRsyjTpzgB-"},"source":["**[15장: 465페이지]**"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"R3KMdXhazgB-","executionInfo":{"status":"ok","timestamp":1702028583190,"user_tz":-540,"elapsed":420,"user":{"displayName":"이석창","userId":"12669722191103790079"}},"outputId":"950c7afe-3054-4ffc-f6dd-540b08f622c3"},"outputs":[{"output_type":"stream","name":"stdout","text":["<?xml version=\"1.0\" encoding=\"UTF-8\" ?>\n","<사용자정보>\n","    <이름>홍길동</이름>\n","    <나이>25</나이>\n","    <거주지>서울</거주지>\n","    <신체정보>\n","        <키 unit=\"cm\">175.4</키>\n","        <몸무게 unit=\"kg\">71.2</몸무게>\n","    </신체정보>\n","    <취미>등산</취미>\n","    <취미>자전거타기</취미>\n","    <취미>독서</취미>\n","</사용자정보> \n","\n"]}],"source":["xml_data = \"\"\"<?xml version=\"1.0\" encoding=\"UTF-8\" ?>\n","<사용자정보>\n","    <이름>홍길동</이름>\n","    <나이>25</나이>\n","    <거주지>서울</거주지>\n","    <신체정보>\n","        <키 unit=\"cm\">175.4</키>\n","        <몸무게 unit=\"kg\">71.2</몸무게>\n","    </신체정보>\n","    <취미>등산</취미>\n","    <취미>자전거타기</취미>\n","    <취미>독서</취미>\n","</사용자정보>\n","\"\"\"\n","print(xml_data)"]},{"cell_type":"code","source":["!pip install xmltodict"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"BjtlU1msz1Qu","executionInfo":{"status":"ok","timestamp":1702028611381,"user_tz":-540,"elapsed":7905,"user":{"displayName":"이석창","userId":"12669722191103790079"}},"outputId":"3433b039-184a-41e5-dd5c-6a2f62e2b90f"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Collecting xmltodict\n","  Downloading xmltodict-0.13.0-py2.py3-none-any.whl (10.0 kB)\n","Installing collected packages: xmltodict\n","Successfully installed xmltodict-0.13.0\n"]}]},{"cell_type":"markdown","metadata":{"id":"Duzilt2gzgB_"},"source":["**[15장: 465페이지]**"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"jPQTe92fzgB_","executionInfo":{"status":"ok","timestamp":1702028615718,"user_tz":-540,"elapsed":4,"user":{"displayName":"이석창","userId":"12669722191103790079"}},"outputId":"0d29de46-23ed-4985-9bad-0c9a7020ed99"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["{'사용자정보': {'이름': '홍길동',\n","  '나이': '25',\n","  '거주지': '서울',\n","  '신체정보': {'키': {'@unit': 'cm', '#text': '175.4'},\n","   '몸무게': {'@unit': 'kg', '#text': '71.2'}},\n","  '취미': ['등산', '자전거타기', '독서']}}"]},"metadata":{},"execution_count":12}],"source":["import xmltodict\n","\n","dict_data = xmltodict.parse(xml_data, xml_attribs=True)\n","dict_data"]},{"cell_type":"markdown","metadata":{"id":"j_2m4AzazgB_"},"source":["**[15장: 466페이지]**"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":36},"id":"JzefvZTuzgB_","executionInfo":{"status":"ok","timestamp":1702028624617,"user_tz":-540,"elapsed":7,"user":{"displayName":"이석창","userId":"12669722191103790079"}},"outputId":"9616142a-82c4-4489-dfe7-da5e0a6a9fd6"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["'홍길동'"],"application/vnd.google.colaboratory.intrinsic+json":{"type":"string"}},"metadata":{},"execution_count":13}],"source":["dict_data['사용자정보']['이름']"]},{"cell_type":"markdown","metadata":{"id":"KUhFSMUSzgB_"},"source":["**[15장: 466페이지]**"]},{"cell_type":"code","execution_count":null,"metadata":{"scrolled":true,"colab":{"base_uri":"https://localhost:8080/"},"id":"ViXP_23TzgB_","executionInfo":{"status":"ok","timestamp":1702028627907,"user_tz":-540,"elapsed":5,"user":{"displayName":"이석창","userId":"12669722191103790079"}},"outputId":"e9c6b222-16db-4d26-90b1-0e70c5be48c2"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["{'키': {'@unit': 'cm', '#text': '175.4'},\n"," '몸무게': {'@unit': 'kg', '#text': '71.2'}}"]},"metadata":{},"execution_count":14}],"source":["dict_data['사용자정보']['신체정보']"]},{"cell_type":"markdown","metadata":{"id":"QcNTgfGrzgB_"},"source":["**[15장: 466 ~ 467페이지]**"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":36},"id":"_ELBtAvvzgB_","executionInfo":{"status":"ok","timestamp":1702028631188,"user_tz":-540,"elapsed":3,"user":{"displayName":"이석창","userId":"12669722191103790079"}},"outputId":"1bfab8f3-a241-4575-dc6e-7768152c214a"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["'cm'"],"application/vnd.google.colaboratory.intrinsic+json":{"type":"string"}},"metadata":{},"execution_count":15}],"source":["dict_data['사용자정보']['신체정보']['키']['@unit']"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":36},"id":"HK8j6s87zgB_","executionInfo":{"status":"ok","timestamp":1702028633634,"user_tz":-540,"elapsed":7,"user":{"displayName":"이석창","userId":"12669722191103790079"}},"outputId":"bbf9a4e2-5580-4b53-8894-dab1b2770453"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["'175.4'"],"application/vnd.google.colaboratory.intrinsic+json":{"type":"string"}},"metadata":{},"execution_count":16}],"source":["dict_data['사용자정보']['신체정보']['키']['#text']"]},{"cell_type":"markdown","metadata":{"id":"Q6v-JBhKzgB_"},"source":["**[15장: 467페이지]**"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"wFOCc3-DzgB_","executionInfo":{"status":"ok","timestamp":1702028638424,"user_tz":-540,"elapsed":456,"user":{"displayName":"이석창","userId":"12669722191103790079"}},"outputId":"030500a0-080f-4500-dac6-42cf80cb5836"},"outputs":[{"output_type":"stream","name":"stdout","text":["[사용자 홍길동의 신체정보]\n","*키: 175.4cm\n","*몸무게: 71.2kg\n"]}],"source":["import xmltodict\n","\n","dict_data = xmltodict.parse(xml_data)\n","\n","user_name = dict_data['사용자정보']['이름']\n","body_data = dict_data['사용자정보']['신체정보']\n","\n","height = body_data['키']['#text']\n","height_unit = body_data['키']['@unit']\n","\n","weight = body_data['몸무게']['#text']\n","weight_unit = body_data['몸무게']['@unit']\n","\n","print(\"[사용자 {0}의 신체정보]\".format(user_name))\n","print(\"*키: {0}{1}\".format(height, height_unit))\n","print(\"*몸무게: {0}{1}\".format(weight, weight_unit))"]},{"cell_type":"markdown","metadata":{"id":"U3P5moF0zgCA"},"source":["**[15장: 467페이지]**"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":204},"id":"Ogn7Y9xBzgCA","executionInfo":{"status":"error","timestamp":1702037727842,"user_tz":-540,"elapsed":353,"user":{"displayName":"이석창","userId":"12669722191103790079"}},"outputId":"1921b863-e628-43c5-88e3-c24e46af9879"},"outputs":[{"output_type":"error","ename":"NameError","evalue":"ignored","traceback":["\u001b[0;31m---------------------------------------------------------------------------\u001b[0m","\u001b[0;31mNameError\u001b[0m                                 Traceback (most recent call last)","\u001b[0;32m<ipython-input-1-f6a2c9f96b14>\u001b[0m in \u001b[0;36m<cell line: 1>\u001b[0;34m()\u001b[0m\n\u001b[0;32m----> 1\u001b[0;31m \u001b[0mdict_data2\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mxmltodict\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mparse\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mxml_data\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mxml_attribs\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;32mFalse\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m      2\u001b[0m \u001b[0mdict_data2\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;31mNameError\u001b[0m: name 'xmltodict' is not defined"]}],"source":["dict_data2 = xmltodict.parse(xml_data, xml_attribs=False)\n","dict_data2"]},{"cell_type":"markdown","metadata":{"id":"3xCXIRpTzgCA"},"source":["### 웹 사이트 주소에 부가 정보 추가하기"]},{"cell_type":"markdown","metadata":{"id":"T-O4TOG3zgCA"},"source":["#### 웹 사이트 주소에 경로 추가하기"]},{"cell_type":"markdown","metadata":{"id":"750rEATfzgCA"},"source":["**[15장: 468페이지]**"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"RJj86-mxzgCA","executionInfo":{"status":"ok","timestamp":1702028647861,"user_tz":-540,"elapsed":2,"user":{"displayName":"이석창","userId":"12669722191103790079"}},"outputId":"02f3aede-760b-4b97-f871-526d20329dc7"},"outputs":[{"output_type":"stream","name":"stdout","text":["https://api.github.com/events\n"]}],"source":["base_url = \"https://api.github.com/\"\n","sub_dir = \"events\"\n","url = base_url + sub_dir\n","print(url)"]},{"cell_type":"markdown","metadata":{"id":"y9bkTZEYzgCA"},"source":["**[15장: 469페이지]**"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"pczaxUDyzgCA","executionInfo":{"status":"ok","timestamp":1702028706258,"user_tz":-540,"elapsed":1730,"user":{"displayName":"이석창","userId":"12669722191103790079"}},"outputId":"c912651f-18a2-4604-bb3b-41a548b5a8bb"},"outputs":[{"output_type":"stream","name":"stdout","text":["https://api.github.com/events\n","https://api.github.com/user\n","https://api.github.com/emails\n"]}],"source":["import requests\n","\n","base_url = \"https://api.github.com/\"\n","sub_dirs = [\"events\", \"user\", \"emails\" ]\n","\n","for sub_dir in sub_dirs:\n","    url_dir = base_url + sub_dir\n","    r = requests.get(url_dir)\n","    print(r.url)"]},{"cell_type":"markdown","metadata":{"id":"uZO_bq4GzgCA"},"source":["#### 웹 사이트 주소에 매개변수 추가하기"]},{"cell_type":"markdown","metadata":{"id":"7new_onizgCA"},"source":["**[15장: 470페이지]**"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"cDxqEuZVzgCB","executionInfo":{"status":"ok","timestamp":1702028716028,"user_tz":-540,"elapsed":456,"user":{"displayName":"이석창","userId":"12669722191103790079"}},"outputId":"b603a456-e506-4199-a78e-dee6cd907900"},"outputs":[{"output_type":"stream","name":"stdout","text":["http://api.openweathermap.org/data/2.5/weather?lat=37.57&lon=126.98&appid=b235c57pc357fb68acr1e81&units=metric\n"]}],"source":["import requests\n","\n","LAT = '37.57' # 위도\n","LON = '126.98' # 경도\n","API_KEY = 'b235c57pc357fb68acr1e81' # API 키(임의의 API 키)\n","UNIT = 'metric' # 단위\n","\n","site_url = \"http://api.openweathermap.org/data/2.5/weather\"\n","parameter = \"?lat=%s&lon=%s&appid=%s&units=%s\"%(LAT, LON, API_KEY, UNIT)\n","url_para = site_url + parameter\n","r = requests.get(url_para)\n","\n","print(r.url)"]},{"cell_type":"markdown","metadata":{"id":"Xj0cAFG0zgCB"},"source":["**[15장: 471페이지]**"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"uoqonSLEzgCB","executionInfo":{"status":"ok","timestamp":1702028722985,"user_tz":-540,"elapsed":458,"user":{"displayName":"이석창","userId":"12669722191103790079"}},"outputId":"a2a3233c-52ea-46d0-a17e-f6b88560c516"},"outputs":[{"output_type":"stream","name":"stdout","text":["http://api.openweathermap.org/data/2.5/weather?lat=37.57&lon=126.98&appid=b235c57pc357fb68acr1e81&units=metric\n"]}],"source":["import requests\n","\n","LAT = '37.57' # 위도\n","LON = '126.98' # 경도\n","API_KEY = 'b235c57pc357fb68acr1e81' # API 키(임의의 API 키)\n","UNIT = 'metric' # 단위\n","\n","req_url = \"http://api.openweathermap.org/data/2.5/weather\"\n","req_parameter = {\"lat\":LAT, \"lon\":LON , \"appid\": API_KEY, \"units\":UNIT}\n","r = requests.get(req_url,params=req_parameter)\n","print(r.url)"]},{"cell_type":"markdown","metadata":{"id":"u4gz5gwRzgCB"},"source":["#### 웹 사이트 주소의 인코딩과 디코딩"]},{"cell_type":"markdown","metadata":{"id":"X_wBEJiqzgCC"},"source":["**[15장: 471 ~ 472페이지]**"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"0mcHbcsYzgCC","executionInfo":{"status":"ok","timestamp":1702038824539,"user_tz":-540,"elapsed":8,"user":{"displayName":"이석창","userId":"12669722191103790079"}},"outputId":"ae0983b9-cd97-45b0-fd05-5f8527bebf84"},"outputs":[{"output_type":"stream","name":"stdout","text":["Encoded url: et5piq3pfpqLEWPpCbvtSQ%2Bertertg%2Bx3evdvbaRBvhWEerg3efac2r3f3RfhDTERTw%2B9rkvoewRV%2Fovmrk3dq%3D%3D\n","Decoded url: et5piq3pfpqLEWPpCbvtSQ+ertertg+x3evdvbaRBvhWEerg3efac2r3f3RfhDTERTw+9rkvoewRV/ovmrk3dq==\n"]}],"source":["import requests\n","\n","API_KEY = \"et5piq3pfpqLEWPpCbvtSQ%2Bertertg%2Bx3evdvbaRBvhWEerg3efac2r3f3RfhDTERTw%2B9rkvoewRV%2Fovmrk3dq%3D%3D\"\n","\n","API_KEY_decode = requests.utils.unquote(API_KEY)\n","\n","print(\"Encoded url:\", API_KEY)\n","print(\"Decoded url:\", API_KEY_decode)"]},{"cell_type":"markdown","metadata":{"id":"S6Q9mI8vzgCC"},"source":["**[15장: 472페이지]**"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"YrI6eJFXzgCC"},"outputs":[],"source":["req_url = \"http://openapi.airkorea.or.kr/openapi/services/rest/MsrstnInfoInqireSvc/getNearbyMsrstnList\"\n","\n","tm_x = 244148.546388\n","tm_y = 412423.75772\n","\n","req_parameter = {\"ServiceKey\":API_KEY_decode, \"tmX\":tm_x, \"tmY\":tm_y}\n","\n","r = requests.get(req_url,  params = req_parameter)\n","print(r.url)"]},{"cell_type":"markdown","metadata":{"id":"mJwJ6pxbzgCC"},"source":["**[15장: 473페이지]**"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"rUzjt-6BzgCC"},"outputs":[],"source":["req_parameter = {\"ServiceKey\":API_KEY, \"tmX\":tm_x, \"tmY\":tm_y}\n","\n","r = requests.get(req_url,  params = req_parameter)\n","print(r.url)"]},{"cell_type":"markdown","metadata":{"id":"_gMcvmBRzgCC"},"source":["## 15.2 API 키를 사용하지 않고 데이터 가져오기"]},{"cell_type":"markdown","metadata":{"id":"8-ojzAOazgCC"},"source":["### 국제 우주 정거장의 정보 가져오기"]},{"cell_type":"markdown","metadata":{"id":"ogKc3ykBzgCC"},"source":["**[15장: 473 ~ 474페이지]**"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"M5jpKZFPzgCD","executionInfo":{"status":"ok","timestamp":1702028736999,"user_tz":-540,"elapsed":783,"user":{"displayName":"이석창","userId":"12669722191103790079"}},"outputId":"7bf3bbfd-14a4-4c5c-f125-1649edd01d8e"},"outputs":[{"output_type":"stream","name":"stdout","text":["{\"timestamp\": 1702028736, \"message\": \"success\", \"iss_position\": {\"longitude\": \"-40.2421\", \"latitude\": \"-3.2221\"}}\n"]}],"source":["import requests\n","import json\n","\n","url = \"http://api.open-notify.org/iss-now.json\"\n","\n","r = requests.get(url)\n","print(r.text)"]},{"cell_type":"markdown","metadata":{"id":"eaq18eOTzgCD"},"source":["**[15장: 474페이지]**"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"6egItUxnzgCD"},"outputs":[],"source":["json_to_dict = json.loads(r.text)\n","type(json_to_dict)"]},{"cell_type":"markdown","metadata":{"id":"s2Ngp7KKzgCD"},"source":["**[15장: 474 ~ 475페이지]**"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"-vOU4HTJzgCD","executionInfo":{"status":"ok","timestamp":1702039205612,"user_tz":-540,"elapsed":2,"user":{"displayName":"이석창","userId":"12669722191103790079"}},"outputId":"d270b902-6bd8-43ae-b70a-fc10e369da32"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["dict"]},"metadata":{},"execution_count":6}],"source":["import requests\n","\n","url = \"http://api.open-notify.org/iss-now.json\"\n","\n","r = requests.get(url)\n","json_to_dict = r.json()\n","type(json_to_dict)"]},{"cell_type":"markdown","metadata":{"id":"rqPtuZkMzgCD"},"source":["**[15장: 475페이지]**"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"Gupk3biEzgCD","executionInfo":{"status":"ok","timestamp":1702039207929,"user_tz":-540,"elapsed":311,"user":{"displayName":"이석창","userId":"12669722191103790079"}},"outputId":"9e3eb1c6-a959-40f7-9410-bee2988b049b"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["dict"]},"metadata":{},"execution_count":7}],"source":["import requests\n","\n","url = \"http://api.open-notify.org/iss-now.json\"\n","\n","json_to_dict = requests.get(url).json()\n","type(json_to_dict)"]},{"cell_type":"markdown","metadata":{"id":"wralmfPhzgCD"},"source":["**[15장: 475페이지]**"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"wcxEjx3pzgCD","executionInfo":{"status":"ok","timestamp":1702039210467,"user_tz":-540,"elapsed":365,"user":{"displayName":"이석창","userId":"12669722191103790079"}},"outputId":"9079544e-4f69-4789-f836-dc1652aac331"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["{'iss_position': {'latitude': '-35.1568', 'longitude': '-115.9421'},\n"," 'timestamp': 1702039207,\n"," 'message': 'success'}"]},"metadata":{},"execution_count":8}],"source":["json_to_dict"]},{"cell_type":"markdown","metadata":{"id":"2irpa4ICzgCD"},"source":["**[15장: 475페이지]**"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"XRRHN_JezgCD","executionInfo":{"status":"ok","timestamp":1702039211324,"user_tz":-540,"elapsed":460,"user":{"displayName":"이석창","userId":"12669722191103790079"}},"outputId":"757ddbe9-cd33-4150-cc3a-937027cb5ad0"},"outputs":[{"output_type":"stream","name":"stdout","text":["{'latitude': '-35.1568', 'longitude': '-115.9421'}\n","-35.1568\n","-115.9421\n","success\n","1702039207\n"]}],"source":["print(json_to_dict[\"iss_position\"])\n","print(json_to_dict[\"iss_position\"][\"latitude\"])\n","print(json_to_dict[\"iss_position\"][\"longitude\"])\n","print(json_to_dict[\"message\"])\n","print(json_to_dict[\"timestamp\"])"]},{"cell_type":"markdown","metadata":{"id":"tgvkFWGazgCE"},"source":["**[15장: 476페이지]**"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"nhZUaK9rzgCE"},"outputs":[],"source":["import requests\n","import time\n","\n","url = \"http://api.open-notify.org/iss-now.json\"\n","\n","def ISS_Position(iss_position_api_url):\n","    json_to_dict = requests.get(iss_position_api_url).json()\n","    return json_to_dict[\"iss_position\"]\n","\n","for k in range(5):\n","    print(ISS_Position(url))\n","    time.sleep(10)  # 10초 동안 코드 실행을 일시적으로 중지한다."]},{"cell_type":"markdown","metadata":{"id":"KVeFf-SQzgCE"},"source":["### 국가 정보 가져오기"]},{"cell_type":"markdown","metadata":{"id":"5wPD5E-VzgCE"},"source":["**[15장: 476 ~ 477페이지]**"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"RliQh9qvzgCE"},"outputs":[],"source":["import requests\n","\n","url_temp = \"https://restcountries.eu/rest/v1/name/\"\n","country = \"South Korea\"\n","url = url_temp + country\n","\n","r = requests.get(url)\n","print(r.text)"]},{"cell_type":"markdown","metadata":{"id":"dznALY-DzgCE"},"source":["**[15장: 477페이지]**"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"E0OauNn0zgCE"},"outputs":[],"source":["json_to_list = requests.get(url).json()\n","json_to_list"]},{"cell_type":"markdown","metadata":{"id":"TBkNO0VFzgCE"},"source":["**[15장: 478페이지]**"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"jfLBkj5IzgCF"},"outputs":[],"source":["json_to_list[0][\"capital\"]"]},{"cell_type":"markdown","metadata":{"id":"nTyG4sBlzgCG"},"source":["**[15장: 478페이지]**"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"ZlyMgWvBzgCG"},"outputs":[],"source":["import requests\n","import json\n","\n","countries =[\"South Korea\", \"United States of America\", \"United Kingdom\", \"France\", \"Germany\"]\n","\n","def country_to_capital(country):\n","    url_temp = \"https://restcountries.eu/rest/v1/name/\"\n","    url = url_temp + country\n","    json_to_list = requests.get(url).json()\n","    return json_to_list[0][\"capital\"]\n","\n","for country in countries:\n","    capital = country_to_capital(country)\n","    print(\"*{0}: {1}\".format(country, capital))"]},{"cell_type":"markdown","metadata":{"id":"jd0byA7ozgCG"},"source":["## 15.3 트위터에 메시지 작성하고 가져오기"]},{"cell_type":"markdown","metadata":{"id":"0TJVWSngzgCG"},"source":[" ### API 키 및 접속 토큰 생성\n"]},{"cell_type":"markdown","metadata":{"id":"yFOo8UPzzgCG"},"source":["### Tweepy 설치 및 인증"]},{"cell_type":"markdown","metadata":{"id":"9xuR0SOJzgCG"},"source":["**[15장: 485페이지]**"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"t7iVwCmizgCG"},"outputs":[],"source":["import tweepy\n","\n","# 본인이 신청해서 생성한 문자열을 각각 복사해 넣습니다.\n","consumer_key = 'YOUR-CONSUMER-KEY'\n","consumer_secret = 'YOUR-CONSUMER-SECRET'\n","\n","access_token = 'YOUR-ACCESS-TOKEN'\n","access_secret = 'YOUR-ACCESS-SECRET'"]},{"cell_type":"markdown","metadata":{"id":"R2PxGURvzgCG"},"source":["**[15장: 485페이지]**"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"JuwaN1vszgCG"},"outputs":[],"source":["auth = tweepy.OAuthHandler(consumer_key, consumer_secret)\n","auth.set_access_token(access_token, access_secret)"]},{"cell_type":"markdown","metadata":{"id":"X78K4x0PzgCG"},"source":["**[15장: 485페이지]**"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"HugGtLSlzgCH"},"outputs":[],"source":["api = tweepy.API(auth)"]},{"cell_type":"markdown","metadata":{"id":"wFjmgBbZzgCH"},"source":["**[15장: 486페이지]**"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"rx11Hg6JzgCH","colab":{"base_uri":"https://localhost:8080/","height":186},"executionInfo":{"status":"error","timestamp":1702271761418,"user_tz":-540,"elapsed":605,"user":{"displayName":"이석창","userId":"12669722191103790079"}},"outputId":"cec4809e-c387-4730-bcbf-ae8a4d675f61"},"outputs":[{"output_type":"error","ename":"AttributeError","evalue":"ignored","traceback":["\u001b[0;31m---------------------------------------------------------------------------\u001b[0m","\u001b[0;31mAttributeError\u001b[0m                            Traceback (most recent call last)","\u001b[0;32m<ipython-input-4-b7b8e6eaf385>\u001b[0m in \u001b[0;36m<cell line: 1>\u001b[0;34m()\u001b[0m\n\u001b[0;32m----> 1\u001b[0;31m \u001b[0mprint\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m\"name:\"\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0mapi\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mme\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mname\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m","\u001b[0;31mAttributeError\u001b[0m: 'API' object has no attribute 'me'"]}],"source":["print(\"name:\",api.me().name)"]},{"cell_type":"markdown","metadata":{"id":"n7Nt2UlFzgCH"},"source":["### 트윗 작성하기"]},{"cell_type":"markdown","metadata":{"id":"7QazjT48zgCH"},"source":["**[15장: 487페이지]**"]},{"cell_type":"code","execution_count":null,"metadata":{"scrolled":true,"id":"vWxgCw29zgCH"},"outputs":[],"source":["tweet_update_status = api.update_status('파이썬에서 Tweepy 라이브러리를 이용한 첫 번째 트윗')"]},{"cell_type":"markdown","metadata":{"id":"W4oDGY30zgCH"},"source":["**[15장: 487페이지]**"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"QcUeAaJtzgCH"},"outputs":[],"source":["tweet_media_update_status = api.update_with_media(\"C:/myPyCode/figures/fig_for_excel1.png\", 'tweepy를 이용한 이미지 올리기')"]},{"cell_type":"markdown","metadata":{"id":"f1EzelNBzgCH"},"source":["### 타임라인에서 메시지 가져오기"]},{"cell_type":"markdown","metadata":{"id":"DQ_mjefRzgCH"},"source":["**[15장: 488페이지]**"]},{"cell_type":"code","execution_count":null,"metadata":{"scrolled":false,"id":"vM05lkREzgCH"},"outputs":[],"source":["for status in tweepy.Cursor(api.home_timeline).items(2):\n","    print(\"*\", status.text)"]},{"cell_type":"markdown","metadata":{"id":"qJBTJmAIzgCH"},"source":["**[15장: 489페이지]**"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"yKF0xsgZzgCI"},"outputs":[],"source":["for status in tweepy.Cursor(api.home_timeline).items(2):\n","    print(\"*\", status._json['text'])\n","    print(\" ==> Created at\", status._json['created_at'])"]},{"cell_type":"markdown","metadata":{"id":"eWmkn0kazgCI"},"source":["### 키워드를 지정해 데이터 가져오기"]},{"cell_type":"markdown","metadata":{"id":"DexKvXeszgCI"},"source":["**[15장: 490페이지]**"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"ug1ROKbDzgCI"},"outputs":[],"source":["import tweepy\n","\n","class MyStreamListener(tweepy.StreamListener):\n","\n","    def on_status(self, status):\n","        print(status.text) # 140자까지 출력"]},{"cell_type":"markdown","metadata":{"id":"ufEqdcmczgCI"},"source":["**[15장: 490페이지]**"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"mZCyPqvazgCI"},"outputs":[],"source":["myStreamListener = MyStreamListener()"]},{"cell_type":"markdown","metadata":{"id":"qmmcKfZxzgCI"},"source":["**[15장: 490페이지]**"]},{"cell_type":"code","execution_count":null,"metadata":{"scrolled":true,"id":"ENewKXObzgCI"},"outputs":[],"source":["myStream = tweepy.Stream(auth, myStreamListener)"]},{"cell_type":"markdown","metadata":{"id":"aYouXlJjzgCI"},"source":["**[15장: 491페이지]**"]},{"cell_type":"code","execution_count":null,"metadata":{"scrolled":true,"id":"OH--IA_CzgCI"},"outputs":[],"source":["#myStream.filter(track = ['파이썬', 'python'])"]},{"cell_type":"markdown","metadata":{"id":"sZQV7fMIzgCI"},"source":["**[15장: 491페이지]**"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"PN2Ou9imzgCI"},"outputs":[],"source":["class MyStreamListener(tweepy.StreamListener):\n","\n","    def __init__(self):\n","        super().__init__()\n","        self.tweet_num = 0\n","\n","    def on_status(self, status):\n","        self.tweet_num = self.tweet_num + 1\n","        if(self.tweet_num <= 5):\n","            print(\"***\", status.text) # 140자까지 출력\n","            return True\n","        else:\n","            return False"]},{"cell_type":"markdown","metadata":{"id":"uqVPtvumzgCJ"},"source":["**[15장: 491페이지]**"]},{"cell_type":"code","execution_count":null,"metadata":{"scrolled":false,"id":"d10sUnV_zgCJ"},"outputs":[],"source":["myStreamListener = MyStreamListener()\n","myStream = tweepy.Stream(auth, myStreamListener)\n","myStream.filter(track = ['머신 러닝', 'Machine Learning'])"]},{"cell_type":"markdown","metadata":{"id":"agqdbohXzgCJ"},"source":["**[15장: 492 ~ 493페이지]**"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"EUE58My2zgCJ"},"outputs":[],"source":["import tweepy\n","\n","# 키, 토근, 비밀번호 지정\n","consumer_key = 'YOUR-CONSUMER-KEY'\n","consumer_secret = 'YOUR-CONSUMER-SECRET'\n","\n","access_token = 'YOUR-ACCESS-TOKEN'\n","access_secret = 'YOUR-ACCESS-SECRET'\n","\n","# OAuth 인증 진행\n","auth = tweepy.OAuthHandler(consumer_key, consumer_secret)\n","auth.set_access_token(access_token, access_secret)\n","\n","# 인증된 auth 변수를 이용해 트위터 API 클래스의 정의\n","class MyStreamListener2(tweepy.StreamListener):\n","\n","    def __init__(self, max_num):\n","        super().__init__()\n","        self.tweet_num = 0\n","        self.max_num = max_num\n","\n","    def on_status(self, status):\n","        self.tweet_num = self.tweet_num + 1\n","        file_name = 'C:/myPyCode/data/twitter_stream_test.txt'\n","        if(self.tweet_num <= self.max_num ):\n","            with open(file_name, 'a', encoding=\"utf-8\") as f:\n","                write_text = \"*** \" + status.text + \"\\n\"\n","                f.write(write_text)\n","            return True\n","        else:\n","            return False\n","\n","    def on_error(self, status):\n","        print(status) # 오류 메시지 출력\n","        return False\n","\n","if __name__ == '__main__':\n","    myStreamListener = MyStreamListener2(5)\n","    myStream = tweepy.Stream(auth, myStreamListener)\n","    myStream.filter(track = ['머신 러닝', 'Machine Learning'])\n","    print(\"End of streaming!\")"]},{"cell_type":"markdown","metadata":{"id":"j8aXbTE1zgCJ"},"source":["## 15.4 정부의 공공 데이터 가져오기"]},{"cell_type":"markdown","metadata":{"id":"JpJE2acYzgCJ"},"source":["### 회원 가입 및 서비스 신청"]},{"cell_type":"markdown","metadata":{"id":"3HxbUm7yzgCK"},"source":["### 주소 및 우편번호 가져오기"]},{"cell_type":"markdown","metadata":{"id":"zq9wuPgvzgCK"},"source":["**[15장: 502페이지]**"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"cixK0iBIzgCK","colab":{"base_uri":"https://localhost:8080/","height":35},"executionInfo":{"status":"ok","timestamp":1702275248065,"user_tz":-540,"elapsed":832,"user":{"displayName":"이석창","userId":"12669722191103790079"}},"outputId":"a0800fa0-f918-4587-df83-923faa0e283c"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["'O7jNwhi5HptRZAX09Q5JklD9mnn5MWdjED5QFMRZNh9mdRIyLu2uaGBrzlclK001lfyssLTie5orFL+pKS5ogQ=='"],"application/vnd.google.colaboratory.intrinsic+json":{"type":"string"}},"metadata":{},"execution_count":15}],"source":["import requests\n","\n","API_KEY  = 'O7jNwhi5HptRZAX09Q5JklD9mnn5MWdjED5QFMRZNh9mdRIyLu2uaGBrzlclK001lfyssLTie5orFL%2BpKS5ogQ%3D%3D' # 자신의 인증키를 복사해서 입력합니다.\n","API_KEY_decode = requests.utils.unquote(API_KEY)\n","API_KEY_decode"]},{"cell_type":"markdown","metadata":{"id":"sD2pKpbfzgCK"},"source":["**[15장: 503페이지]**"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"zDg5EALozgCK","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1702275251036,"user_tz":-540,"elapsed":742,"user":{"displayName":"이석창","userId":"12669722191103790079"}},"outputId":"9befea7a-52fc-4823-d2de-664f47ae8919"},"outputs":[{"output_type":"stream","name":"stdout","text":["<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?><NewAddressListResponse><cmmMsgHeader><requestMsgId></requestMsgId><responseMsgId></responseMsgId><responseTime>20231211:151409557</responseTime><successYN>Y</successYN><returnCode>00</returnCode><errMsg></errMsg><totalCount>1</totalCount><countPerPage>10</countPerPage><totalPage>1</totalPage><currentPage></currentPage></cmmMsgHeader><newAddressListAreaCd><zipNo>06579</zipNo><lnmAdres>서울특별시 서초구 반포대로 201 (반포동, 국립중앙도서관)</lnmAdres><rnAdres>서울특별시 서초구 반포동 산60-1 국립중앙도서관</rnAdres></newAddressListAreaCd></NewAddressListResponse>\n"]}],"source":["req_url = \"http://openapi.epost.go.kr/postal/retrieveNewAdressAreaCdService/retrieveNewAdressAreaCdService/getNewAddressListAreaCd\"\n","\n","search_Se = \"road\"\n","srch_wrd = \"반포대로 201\"\n","\n","req_parameter = {\"ServiceKey\":API_KEY_decode, \"searchSe\":search_Se, \"srchwrd\":srch_wrd}\n","\n","r = requests.get(req_url, params = req_parameter)\n","xml_data = r.text\n","print(xml_data)"]},{"cell_type":"markdown","metadata":{"id":"ScY1G5v6zgCK"},"source":["**[15장: 503페이지]**"]},{"cell_type":"code","source":["!pip install xmltodict"],"metadata":{"id":"ahl3945TfGZT"},"execution_count":null,"outputs":[]},{"cell_type":"code","execution_count":null,"metadata":{"id":"GYKXC1YizgCL","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1702274840617,"user_tz":-540,"elapsed":4,"user":{"displayName":"이석창","userId":"12669722191103790079"}},"outputId":"106230ab-6792-4e42-8d3b-ecc93a77d619"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["{'NewAddressListResponse': {'cmmMsgHeader': {'requestMsgId': None,\n","   'responseMsgId': None,\n","   'responseTime': '20231211:150639451',\n","   'successYN': 'N',\n","   'returnCode': '30',\n","   'errMsg': 'SERVICE KEY IS NOT REGISTERED ERROR.'}}}"]},"metadata":{},"execution_count":14}],"source":["import xmltodict\n","\n","dict_data = xmltodict.parse(xml_data)\n","dict_data"]},{"cell_type":"markdown","metadata":{"id":"0I6CpnelzgCL"},"source":["**[15장: 504페이지]**"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Gj1ABMyCzgCL"},"outputs":[],"source":["adress_list = dict_data['NewAddressListResponse']['newAddressListAreaCd']\n","\n","print(\"[입력한 도로명 주소]\", srch_wrd)\n","print(\"[응답 데이터에서 추출한 결과]\")\n","print(\"- 우편번호:\", adress_list['zipNo'])\n","print(\"- 도로명 주소:\", adress_list['lnmAdres'])\n","print(\"- 지번 주소:\", adress_list['rnAdres'])"]},{"cell_type":"markdown","metadata":{"id":"7YAlzrWhzgCL"},"source":["### 날씨 정보 가져오기"]},{"cell_type":"markdown","metadata":{"id":"GmvHdWHAzgCL"},"source":["#### 날씨 정보를 위한 서비스 신청"]},{"cell_type":"markdown","metadata":{"id":"94pUEtmxzgCL"},"source":["#### 날씨 실황 조회"]},{"cell_type":"markdown","metadata":{"id":"Jgy_zWcEzgCL"},"source":["**[15장: 509페이지]**"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"nM14QLnRzgCL","colab":{"base_uri":"https://localhost:8080/","height":35},"executionInfo":{"status":"ok","timestamp":1702276000475,"user_tz":-540,"elapsed":938,"user":{"displayName":"이석창","userId":"12669722191103790079"}},"outputId":"3a9218ff-8758-479c-ed3b-ab26e7d1783c"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["'O7jNwhi5HptRZAX09Q5JklD9mnn5MWdjED5QFMRZNh9mdRIyLu2uaGBrzlclK001lfyssLTie5orFL+pKS5ogQ=='"],"application/vnd.google.colaboratory.intrinsic+json":{"type":"string"}},"metadata":{},"execution_count":24}],"source":["import requests\n","\n","API_KEY  = 'O7jNwhi5HptRZAX09Q5JklD9mnn5MWdjED5QFMRZNh9mdRIyLu2uaGBrzlclK001lfyssLTie5orFL%2BpKS5ogQ%3D%3D' # 자신의 인증키를 복사해서 입력합니다.\n","API_KEY_decode = requests.utils.unquote(API_KEY)\n","API_KEY_decode"]},{"cell_type":"markdown","metadata":{"id":"3XTVIchZzgCL"},"source":["**[15장: 510 ~ 511페이지]**"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"DqcWtmAxzgCL","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1702277837957,"user_tz":-540,"elapsed":872,"user":{"displayName":"이석창","userId":"12669722191103790079"}},"outputId":"b18a7f5f-1264-4965-c7b5-16f88c8a8e0d"},"outputs":[{"output_type":"stream","name":"stdout","text":["0600\n","20231211 1200 600\n","{\"response\":{\"header\":{\"resultCode\":\"00\",\"resultMsg\":\"NORMAL_SERVICE\"},\"body\":{\"dataType\":\"JSON\",\"items\":{\"item\":[{\"baseDate\":\"20231211\",\"baseTime\":\"1200\",\"category\":\"PTY\",\"nx\":60,\"ny\":127,\"obsrValue\":\"1\"},{\"baseDate\":\"20231211\",\"baseTime\":\"1200\",\"category\":\"REH\",\"nx\":60,\"ny\":127,\"obsrValue\":\"88\"},{\"baseDate\":\"20231211\",\"baseTime\":\"1200\",\"category\":\"RN1\",\"nx\":60,\"ny\":127,\"obsrValue\":\"1.9\"},{\"baseDate\":\"20231211\",\"baseTime\":\"1200\",\"category\":\"T1H\",\"nx\":60,\"ny\":127,\"obsrValue\":\"9.3\"},{\"baseDate\":\"20231211\",\"baseTime\":\"1200\",\"category\":\"UUU\",\"nx\":60,\"ny\":127,\"obsrValue\":\"-5\"},{\"baseDate\":\"20231211\",\"baseTime\":\"1200\",\"category\":\"VEC\",\"nx\":60,\"ny\":127,\"obsrValue\":\"146\"}]},\"pageNo\":1,\"numOfRows\":6,\"totalCount\":8}}}\n"]},{"output_type":"execute_result","data":{"text/plain":["{'response': {'header': {'resultCode': '00', 'resultMsg': 'NORMAL_SERVICE'},\n","  'body': {'dataType': 'JSON',\n","   'items': {'item': [{'baseDate': '20231211',\n","      'baseTime': '1200',\n","      'category': 'PTY',\n","      'nx': 60,\n","      'ny': 127,\n","      'obsrValue': '1'},\n","     {'baseDate': '20231211',\n","      'baseTime': '1200',\n","      'category': 'REH',\n","      'nx': 60,\n","      'ny': 127,\n","      'obsrValue': '88'},\n","     {'baseDate': '20231211',\n","      'baseTime': '1200',\n","      'category': 'RN1',\n","      'nx': 60,\n","      'ny': 127,\n","      'obsrValue': '1.9'},\n","     {'baseDate': '20231211',\n","      'baseTime': '1200',\n","      'category': 'T1H',\n","      'nx': 60,\n","      'ny': 127,\n","      'obsrValue': '9.3'},\n","     {'baseDate': '20231211',\n","      'baseTime': '1200',\n","      'category': 'UUU',\n","      'nx': 60,\n","      'ny': 127,\n","      'obsrValue': '-5'},\n","     {'baseDate': '20231211',\n","      'baseTime': '1200',\n","      'category': 'VEC',\n","      'nx': 60,\n","      'ny': 127,\n","      'obsrValue': '146'}]},\n","   'pageNo': 1,\n","   'numOfRows': 6,\n","   'totalCount': 8}}}"]},"metadata":{},"execution_count":48}],"source":["import json\n","import datetime\n","\n","# [날짜 및 시간 설정]\n","now = datetime.datetime.now() # 현재 날짜 및 시간 반환\n","\n","# baseDate에 날짜를 입력하기 위해 날짜를 출력 형식을 지정해 변수에 할당\n","date = \"{:%Y%m%d}\".format(now)\n","\n","# baseTime에 시간(정시)를 입력하기 위해 출력 형식을 지정해 시간만 변수에 할당\n","time = \"{:%H00}\".format(now)\n","print(time)\n","\n","# 현재 분이 30분 이전이면 이전 시간(정시)을 설정\n","if (now.minute >= 30):\n","    time = \"{0}00\".format(now.hour)\n","else:\n","    time = \"{0}00\".format(now.hour-1)\n","\n","# [요청 주소 및 요청 변수 지정]\n","#req_url = \"http://newsky2.kma.go.kr/service/SecndSrtpdFrcstInfoService2/ForecastGrib\" <= 예전 주소\n","req_url = 'http://apis.data.go.kr/1360000/VilageFcstInfoService_2.0/getUltraSrtNcst'\n","\n","baseDate = date # 발표 일자 지정\n","#baseTime = time  # 발표 시간 지정(정시로 지정)\n","#print(baseTime)\n","\n","baseTime = 1200\n","\n","print(baseDate, baseTime, time)\n","\n","nx_val = 60 # 예보지점 X 좌표(서울시 종로구 사직동)\n","ny_val = 127 # 예보지점 Y 좌표(서울시 종로구 사직동)\n","\n","num_of_rows = 6 # 한 페이지에 포함된 결과 수\n","page_no = 1 # 페이지 번호\n","\n","output_type = \"JSON\" # 응답 데이터 형식 지정\n","\n","req_parameter = {\"ServiceKey\":API_KEY_decode,\n","                 \"nx\":nx_val, \"ny\": ny_val,\n","                 \"base_date\":baseDate, \"base_time\":baseTime,\n","                 \"pageNo\":page_no, \"numOfRows\":num_of_rows,\n","                 \"dataType\":output_type}\n","\n","# [데이터 요청]\n","r = requests.get(req_url, params = req_parameter)\n","print(r.text)\n","\n","# [JSON 형태로 응답받은 데이터를 딕셔너리 데이터로 변환]\n","dict_data = r.json()\n","dict_data"]},{"cell_type":"markdown","metadata":{"id":"C4p_wWrvzgCM"},"source":["**[15장: 512 ~ 513페이지]**"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"yvr7-jT3zgCM","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1702277482113,"user_tz":-540,"elapsed":5,"user":{"displayName":"이석창","userId":"12669722191103790079"}},"outputId":"8a262325-1748-4d77-c08d-94463eba2a86"},"outputs":[{"output_type":"stream","name":"stdout","text":["[ 발표 날짜: 20231211 ]\n","[ 발표 시간: 1200 ]\n","['없음', '비', '진눈개비', '눈']\n","* 강수: 비\n","* 습도: 88 퍼센트\n","* 기온: 9.3 도\n"]}],"source":["# [딕셔너리 데이터를 분석해서 원하는 값 추출]\n","\n","weather_items = dict_data['response']['body']['items']['item']\n","\n","sky_cond = [\"맑음\", \"구름 조금\", \"구름 많음\", \"흐림\"]\n","rain_type = [\"없음\", \"비\", \"진눈개비\", \"눈\"]\n","\n","print(\"[ 발표 날짜: {} ]\".format(weather_items[0]['baseDate']))\n","print(\"[ 발표 시간: {} ]\".format(weather_items[0]['baseTime']))\n","\n","for k in range(len(weather_items)):\n","    weather_item = weather_items[k]\n","    obsrValue = weather_item['obsrValue']\n","    if(weather_item['category'] == 'T1H'):\n","        print(\"* 기온: {} 도\".format(obsrValue))\n","    elif(weather_item['category'] == 'REH'):\n","        print(\"* 습도: {} 퍼센트\".format(obsrValue))\n","    elif(weather_item['category'] == 'SKY'):\n","        print(sky_cond)\n","        print(\"* 하늘: {}\".format(sky_cond[obsrValue-1]))\n","    elif(weather_item['category'] == 'PTY'):\n","        print(rain_type)\n","        print(\"* 강수: {}\".format(rain_type[int(obsrValue)]))"]},{"cell_type":"markdown","metadata":{"id":"Qq65ja-dzgCM"},"source":["#### 일기 예보 조회"]},{"cell_type":"markdown","metadata":{"id":"j4Dh3GYKzgCM"},"source":["**[15장: 513 ~ 515페이지]**"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"HX_ersYBzgCM"},"outputs":[],"source":["import json\n","import datetime\n","\n","# [날짜 및 시간 설정]\n","now = datetime.datetime.now() # 현재 날짜 및 시간 반환\n","\n","# baseDate에 날짜를 입력하기 위해 날짜를 출력 형식을 지정해 변수에 할당\n","date = \"{:%Y%m%d}\".format(now)\n","\n","# baseTime에 시간(정시)를 입력하기 위해 출력 형식을 지정해 시간만 변수에 할당\n","time = \"{:%H00}\".format(now)\n","\n","# 현재 분이 30분 이전이면 이전 시간(정시)을 설정\n","if (now.minute >= 30):\n","    time = \"{0}00\".format(now.hour)\n","else:\n","    time = \"{0}00\".format(now.hour-1)\n","\n","\n","# [요청 주소 및 요청 변수 지정]\n","req_url = \"http://newsky2.kma.go.kr/service/SecndSrtpdFrcstInfoService2/ForecastTimeData\"\n","\n","baseDate = date # 발표 일자 지정\n","baseTime = time # time  # 발표 시간 지정(정시로 지정)\n","\n","nx_val = 60 # 예보지점 X 좌표(서울시 종로구 사직동)\n","ny_val = 127 # 예보지점 Y 좌표(서울시 종로구 사직동)\n","\n","num_of_rows = 30 # 한 페이지에 포함된 결과 수\n","page_no = 1 # 페이지 번호\n","\n","output_type = \"json\" # 응답 데이터 형식 지정\n","\n","req_parameter = {\"ServiceKey\":API_KEY_decode,\n","                 \"nx\":nx_val, \"ny\": ny_val,\n","                 \"base_date\":baseDate, \"base_time\":baseTime,\n","                 \"pageNo\":page_no, \"numOfRows\":num_of_rows,\n","                 \"_type\":output_type}\n","\n","# [데이터 요청]\n","r = requests.get(req_url, params = req_parameter)\n","\n","# [JSON 형태로 응답받은 데이터를 딕셔너리 데이터로 변환]\n","dict_data = r.json()\n","\n","# [딕셔너리 데이터를 분석해서 원하는 값 추출]\n","weather_items = dict_data['response']['body']['items']['item']\n","\n","sky_cond = [\"맑음\", \"구름 조금\", \"구름 많음\", \"흐림\"]\n","rain_type = [\"없음\", \"비\", \"진눈개비\", \"눈\"]\n","\n","print(\"[ 발표 날짜: {} ]\".format(weather_items[0]['baseDate']))\n","print(\"[ 발표 시간: {} ]\".format(weather_items[0]['baseTime']))\n","\n","print(\"[ 초단기 일기 예보 ]\")\n","\n","for k in range(len(weather_items)):\n","    weather_item = weather_items[k]\n","\n","    fcstTime = weather_item['fcstTime']\n","    fcstValue = weather_item['fcstValue']\n","\n","    if(weather_item['category'] == 'T1H'):\n","        print(\"* 시간: {0}, 기온: {1} 도\".format(fcstTime, fcstValue))\n","    elif(weather_item['category'] == 'REH'):\n","        print(\"* 시간: {0}, 습도: {1} 퍼센트\".format(fcstTime, fcstValue))\n","    elif(weather_item['category'] == 'SKY'):\n","        print(\"* 시간: {0}, 하늘: {1}\".format(fcstTime, sky_cond[fcstValue-1]))\n","    elif(weather_item['category'] == 'PTY'):\n","        print(\"* 시간: {0}, 강수: {1}\".format(fcstTime, rain_type[fcstValue]))"]},{"cell_type":"markdown","metadata":{"id":"T3Kprw4ozgCM"},"source":["### 대기 오염 정보 가져오기"]},{"cell_type":"markdown","source":[],"metadata":{"id":"xV2Dif-h9XYl"}},{"cell_type":"markdown","metadata":{"id":"PnDC0Gd8zgCM"},"source":["#### 대기 오염 정보를 위한 서비스 신청"]},{"cell_type":"markdown","metadata":{"id":"m3BSrA5szgCN"},"source":["#### 측정소"]},{"cell_type":"markdown","metadata":{"id":"xKmHUDPFzgCN"},"source":["**[15장: 519페이지]**"]},{"cell_type":"code","execution_count":2,"metadata":{"id":"yhCc9fjPzgCN","colab":{"base_uri":"https://localhost:8080/","height":35},"executionInfo":{"status":"ok","timestamp":1703899274149,"user_tz":-540,"elapsed":364,"user":{"displayName":"이석창","userId":"12669722191103790079"}},"outputId":"5d464b4a-b918-4a55-c54f-12d945c78dd3"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["'O7jNwhi5HptRZAX09Q5JklD9mnn5MWdjED5QFMRZNh9mdRIyLu2uaGBrzlclK001lfyssLTie5orFL+pKS5ogQ=='"],"application/vnd.google.colaboratory.intrinsic+json":{"type":"string"}},"metadata":{},"execution_count":2}],"source":["import requests\n","\n","API_KEY  = 'O7jNwhi5HptRZAX09Q5JklD9mnn5MWdjED5QFMRZNh9mdRIyLu2uaGBrzlclK001lfyssLTie5orFL%2BpKS5ogQ%3D%3D' # 자신의 인증키를 복사해서 입력합니다.\n","API_KEY_decode = requests.utils.unquote(API_KEY)\n","API_KEY_decode"]},{"cell_type":"markdown","metadata":{"id":"C4umYVTazgCN"},"source":["**[15장: 520페이지]**"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"gVQZ_kHvzgCN","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1702280736845,"user_tz":-540,"elapsed":3691,"user":{"displayName":"이석창","userId":"12669722191103790079"}},"outputId":"4829c2bb-6992-4c63-9f73-f158e58a8154"},"outputs":[{"output_type":"stream","name":"stdout","text":["{'response': {'body': {'totalCount': 2, 'items': [{'sggName': '동구', 'umdName': '둔산동', 'tmX': '352312.977745', 'tmY': '268781.356403', 'sidoName': '대구광역시'}, {'sggName': '서구', 'umdName': '둔산동', 'tmX': '234640.487848', 'tmY': '317347.979649', 'sidoName': '대전광역시'}], 'pageNo': 1, 'numOfRows': 10}, 'header': {'resultMsg': 'NORMAL_CODE', 'resultCode': '00'}}}\n","2\n"]}],"source":["#req_url = \"http://openapi.airkorea.or.kr/openapi/services/rest/MsrstnInfoInqireSvc/getTMStdrCrdnt\"\n","req_url = 'http://apis.data.go.kr/B552584/MsrstnInfoInqireSvc/getTMStdrCrdnt'\n","\n","umd_name = \"둔산동\" #읍, 면, 동 지정\n","num_of_rows = 10 # 한 페이지에 포함된 결과 수\n","page_no = 1 # 페이지 번호\n","\n","output_type = \"json\"\n","\n","req_parameter = {\"serviceKey\":API_KEY_decode, \"umdName\":umd_name,\n","                  \"pageNo\":page_no, \"numOfRows\":num_of_rows,\n","                 \"returnType\":output_type}\n","\n","dict_data = requests.get(req_url, params = req_parameter).json()\n","print(dict_data)\n","dict_data['response']['body']['totalCount'] # 전체 결과의 개수\n","total = dict_data['response']['body']['totalCount']\n","print(total)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"RrLkeqX5zgCO","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1702280754766,"user_tz":-540,"elapsed":521,"user":{"displayName":"이석창","userId":"12669722191103790079"}},"outputId":"38509669-7cfc-4e43-8a13-d08fc2f5d875"},"outputs":[{"output_type":"stream","name":"stdout","text":["[입력한 읍/면/동명] 둔산동\n","[TM 기준 좌표 조회 결과]\n","[{'sggName': '동구', 'umdName': '둔산동', 'tmX': '352312.977745', 'tmY': '268781.356403', 'sidoName': '대구광역시'}, {'sggName': '서구', 'umdName': '둔산동', 'tmX': '234640.487848', 'tmY': '317347.979649', 'sidoName': '대전광역시'}]\n","[{'sggName': '동구', 'umdName': '둔산동', 'tmX': '352312.977745', 'tmY': '268781.356403', 'sidoName': '대구광역시'}, {'sggName': '서구', 'umdName': '둔산동', 'tmX': '234640.487848', 'tmY': '317347.979649', 'sidoName': '대전광역시'}]\n","- 위치: 대구광역시 동구 둔산동\n","- k = 0, TM 좌표(X, Y): 352312.977745, 268781.356403\n","\n","- 위치: 대전광역시 서구 둔산동\n","- k = 1, TM 좌표(X, Y): 234640.487848, 317347.979649\n","\n"]}],"source":["print(\"[입력한 읍/면/동명]\", umd_name)\n","print(\"[TM 기준 좌표 조회 결과]\")\n","print(dict_data['response']['body']['items']) # list\n","dict_data['list'] = dict_data['response']['body']['items']\n","print(dict_data['list'])\n","\n","for k in range(total):\n","    sgg = dict_data['list'][k]['sggName']\n","    umd = dict_data['list'][k]['umdName']\n","    tmX = dict_data['list'][k]['tmX']\n","    tmY = dict_data['list'][k]['tmY']\n","    sido = dict_data['list'][k]['sidoName']\n","\n","    print(\"- 위치: {0} {1} {2}\".format(sido, sgg, umd))\n","    print(\"- k = {0}, TM 좌표(X, Y): {1}, {2}\\n\".format(k, tmX, tmY))"]},{"cell_type":"markdown","metadata":{"id":"YGa0Ho90zgCO"},"source":["**[15장: 521페이지]**"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"jx2FMHqvzgCO","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1702280766849,"user_tz":-540,"elapsed":517,"user":{"displayName":"이석창","userId":"12669722191103790079"}},"outputId":"c7b22b46-96a6-4367-d00a-380e40956e1a"},"outputs":[{"output_type":"stream","name":"stdout","text":["TM 좌표(X, Y): 352312.977745, 268781.356403\n"]}],"source":["k = 0 # 원하는 위치 선택 (여기서는 첫 번째 위치)\n","TM_X = dict_data['list'][k]['tmX'] # TM X 좌표\n","TM_Y = dict_data['list'][k]['tmY'] # TM Y 좌표\n","print(\"TM 좌표(X, Y): {0}, {1}\".format(TM_X, TM_Y))"]},{"cell_type":"markdown","metadata":{"id":"UpkuFVBNzgCS"},"source":["**[15장: 522 ~ 523페이지]**"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"x2fsHwmwzgCT","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1702281163136,"user_tz":-540,"elapsed":528,"user":{"displayName":"이석창","userId":"12669722191103790079"}},"outputId":"f26eb840-68dc-4d78-8a38-6c966c06e93f"},"outputs":[{"output_type":"stream","name":"stdout","text":["{'response': {'body': {'totalCount': 3, 'items': [{'tm': 1314.5, 'addr': '제주특별자치도 서귀포시 대정읍 동일하모로149번길 21-8 대정청소년수련관', 'stationName': '대정읍'}, {'tm': 1317.8, 'addr': '제주 제주시 한경면 고산리 3762', 'stationName': '고산리'}, {'tm': 1325.9, 'addr': '제주특별자치도 서귀포시 일주서로 166 제주 유나이티드 연습구장 옆(지상) (강정동)', 'stationName': '강정동'}], 'pageNo': 1, 'numOfRows': 10}, 'header': {'resultMsg': 'NORMAL_CODE', 'resultCode': '00'}}}\n","해당 지역 근처에 있는 측정소의 개수: 3\n"]}],"source":["#req_url = \"http://openapi.airkorea.or.kr/openapi/services/rest/MsrstnInfoInqireSvc/getNearbyMsrstnList\"\n","req_url = 'http://apis.data.go.kr/B552584/MsrstnInfoInqireSvc/getNearbyMsrstnList'\n","\n","x_value = TM_X # TM 측정방식 X좌표\n","y_value = TM_Y # TM 측정방식 Y좌표\n","\n","num_of_rows = 10 # 한 페이지에 포함된 결과 수\n","page_no = 1 # 페이지 번호\n","ver = 1.0\n","output_type = \"json\"\n","req_parameter = {\"ServiceKey\":API_KEY_decode,\n","                 \"tmX\":x_value, \"tmY\":y_value,\n","                 \"ver\":ver,\n","                 \"returnType\":output_type}\n","\n","dict_data = requests.get(req_url, params = req_parameter).json()\n","print(dict_data)\n","print(\"해당 지역 근처에 있는 측정소의 개수:\", dict_data['response']['body']['totalCount'])\n","total2 = dict_data['response']['body']['totalCount']"]},{"cell_type":"markdown","metadata":{"id":"BzkblGafzgCT"},"source":["**[15장: 523페이지]**"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Zj4mJddozgCT","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1702281220214,"user_tz":-540,"elapsed":555,"user":{"displayName":"이석창","userId":"12669722191103790079"}},"outputId":"be2879d7-452b-4c89-c74a-aacc5bb489e2"},"outputs":[{"output_type":"stream","name":"stdout","text":["[측정소 정보]\n","[{'tm': 1314.5, 'addr': '제주특별자치도 서귀포시 대정읍 동일하모로149번길 21-8 대정청소년수련관', 'stationName': '대정읍'}, {'tm': 1317.8, 'addr': '제주 제주시 한경면 고산리 3762', 'stationName': '고산리'}, {'tm': 1325.9, 'addr': '제주특별자치도 서귀포시 일주서로 166 제주 유나이티드 연습구장 옆(지상) (강정동)', 'stationName': '강정동'}]\n","- 측정소 이름:대정읍, 거리:1314.5[km]\n","- 측정소 주소:제주특별자치도 서귀포시 대정읍 동일하모로149번길 21-8 대정청소년수련관 \n","\n","- 측정소 이름:고산리, 거리:1317.8[km]\n","- 측정소 주소:제주 제주시 한경면 고산리 3762 \n","\n","- 측정소 이름:강정동, 거리:1325.9[km]\n","- 측정소 주소:제주특별자치도 서귀포시 일주서로 166 제주 유나이티드 연습구장 옆(지상) (강정동) \n","\n"]}],"source":["print(\"[측정소 정보]\")\n","dict_data['list'] = dict_data['response']['body']['items']\n","print(dict_data['list'])\n","\n","for k in range(total2):\n","\n","    stationName = dict_data['list'][k]['stationName']\n","    ditance = dict_data['list'][k]['tm']\n","    addr = dict_data['list'][k]['addr']\n","\n","    print(\"- 측정소 이름:{0}, 거리:{1}[km]\".format(stationName, ditance))\n","    print(\"- 측정소 주소:{0} \\n\".format(addr))"]},{"cell_type":"markdown","metadata":{"id":"3-keES-HzgCT"},"source":["#### 측정 정보 가져오기 => 찾아야함"]},{"cell_type":"markdown","metadata":{"id":"5bAWHmpGzgCT"},"source":["**[15장: 525페이지]**"]},{"cell_type":"code","execution_count":32,"metadata":{"id":"i1tuZx6MzgCT","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1703900537172,"user_tz":-540,"elapsed":2163,"user":{"displayName":"이석창","userId":"12669722191103790079"}},"outputId":"9c186cc6-63a7-4e03-f028-d1b7ad01ec9d"},"outputs":[{"output_type":"stream","name":"stdout","text":["{'response': {'body': {'totalCount': 23, 'items': [{'pm25Grade1h': '4', 'pm10Value24': '65', 'so2Value': '0.003', 'pm10Grade1h': '3', 'o3Grade': '1', 'pm10Value': '94', 'pm25Flag': None, 'khaiGrade': None, 'pm25Value': '89', 'no2Flag': None, 'mangName': '도시대기', 'no2Value': '0.033', 'so2Grade': '1', 'coFlag': None, 'khaiValue': '-', 'coValue': '0.9', 'pm10Flag': None, 'no2Grade': '2', 'pm25Value24': '-', 'o3Flag': None, 'pm25Grade': None, 'so2Flag': None, 'coGrade': '1', 'dataTime': '2023-12-30 10:00', 'pm10Grade': '2', 'o3Value': '0.003'}, {'pm25Grade1h': None, 'pm10Value24': '62', 'so2Value': '0.004', 'pm10Grade1h': '2', 'o3Grade': '1', 'pm10Value': '79', 'pm25Flag': '통신장애', 'khaiGrade': None, 'pm25Value': '-', 'no2Flag': None, 'mangName': '도시대기', 'no2Value': '0.030', 'so2Grade': '1', 'coFlag': None, 'khaiValue': '-', 'coValue': '0.9', 'pm10Flag': None, 'no2Grade': '1', 'pm25Value24': '-', 'o3Flag': None, 'pm25Grade': None, 'so2Flag': None, 'coGrade': '1', 'dataTime': '2023-12-30 09:00', 'pm10Grade': '2', 'o3Value': '0.003'}, {'pm25Grade1h': None, 'pm10Value24': '62', 'so2Value': '0.004', 'pm10Grade1h': '2', 'o3Grade': '1', 'pm10Value': '62', 'pm25Flag': '통신장애', 'khaiGrade': None, 'pm25Value': '-', 'no2Flag': None, 'mangName': '도시대기', 'no2Value': '0.029', 'so2Grade': '1', 'coFlag': None, 'khaiValue': '-', 'coValue': '0.9', 'pm10Flag': None, 'no2Grade': '1', 'pm25Value24': '-', 'o3Flag': None, 'pm25Grade': None, 'so2Flag': None, 'coGrade': '1', 'dataTime': '2023-12-30 08:00', 'pm10Grade': '2', 'o3Value': '0.002'}, {'pm25Grade1h': None, 'pm10Value24': '62', 'so2Value': '0.004', 'pm10Grade1h': '2', 'o3Grade': '1', 'pm10Value': '56', 'pm25Flag': '통신장애', 'khaiGrade': None, 'pm25Value': '-', 'no2Flag': None, 'mangName': '도시대기', 'no2Value': '0.028', 'so2Grade': '1', 'coFlag': None, 'khaiValue': '-', 'coValue': '0.9', 'pm10Flag': None, 'no2Grade': '1', 'pm25Value24': '-', 'o3Flag': None, 'pm25Grade': None, 'so2Flag': None, 'coGrade': '1', 'dataTime': '2023-12-30 07:00', 'pm10Grade': '2', 'o3Value': '0.002'}, {'pm25Grade1h': None, 'pm10Value24': '63', 'so2Value': '0.003', 'pm10Grade1h': '2', 'o3Grade': '1', 'pm10Value': '58', 'pm25Flag': '통신장애', 'khaiGrade': None, 'pm25Value': '-', 'no2Flag': None, 'mangName': '도시대기', 'no2Value': '0.031', 'so2Grade': '1', 'coFlag': None, 'khaiValue': '-', 'coValue': '1.0', 'pm10Flag': None, 'no2Grade': '2', 'pm25Value24': '-', 'o3Flag': None, 'pm25Grade': None, 'so2Flag': None, 'coGrade': '1', 'dataTime': '2023-12-30 06:00', 'pm10Grade': '2', 'o3Value': '0.002'}, {'pm25Grade1h': None, 'pm10Value24': '65', 'so2Value': '0.004', 'pm10Grade1h': '2', 'o3Grade': '1', 'pm10Value': '64', 'pm25Flag': '통신장애', 'khaiGrade': None, 'pm25Value': '-', 'no2Flag': None, 'mangName': '도시대기', 'no2Value': '0.034', 'so2Grade': '1', 'coFlag': None, 'khaiValue': '-', 'coValue': '0.9', 'pm10Flag': None, 'no2Grade': '2', 'pm25Value24': '-', 'o3Flag': None, 'pm25Grade': None, 'so2Flag': None, 'coGrade': '1', 'dataTime': '2023-12-30 05:00', 'pm10Grade': '2', 'o3Value': '0.002'}, {'pm25Grade1h': None, 'pm10Value24': '66', 'so2Value': '0.003', 'pm10Grade1h': '2', 'o3Grade': '1', 'pm10Value': '59', 'pm25Flag': '통신장애', 'khaiGrade': None, 'pm25Value': '-', 'no2Flag': None, 'mangName': '도시대기', 'no2Value': '0.036', 'so2Grade': '1', 'coFlag': None, 'khaiValue': '-', 'coValue': '0.9', 'pm10Flag': None, 'no2Grade': '2', 'pm25Value24': '-', 'o3Flag': None, 'pm25Grade': None, 'so2Flag': None, 'coGrade': '1', 'dataTime': '2023-12-30 04:00', 'pm10Grade': '2', 'o3Value': '0.002'}, {'pm25Grade1h': None, 'pm10Value24': '67', 'so2Value': '0.004', 'pm10Grade1h': '2', 'o3Grade': '1', 'pm10Value': '64', 'pm25Flag': '통신장애', 'khaiGrade': None, 'pm25Value': '-', 'no2Flag': None, 'mangName': '도시대기', 'no2Value': '0.038', 'so2Grade': '1', 'coFlag': None, 'khaiValue': '-', 'coValue': '0.9', 'pm10Flag': None, 'no2Grade': '2', 'pm25Value24': '-', 'o3Flag': None, 'pm25Grade': None, 'so2Flag': None, 'coGrade': '1', 'dataTime': '2023-12-30 03:00', 'pm10Grade': '2', 'o3Value': '0.002'}, {'pm25Grade1h': '3', 'pm10Value24': '67', 'so2Value': '0.004', 'pm10Grade1h': '2', 'o3Grade': '1', 'pm10Value': '69', 'pm25Flag': None, 'khaiGrade': '3', 'pm25Value': '65', 'no2Flag': None, 'mangName': '도시대기', 'no2Value': '0.039', 'so2Grade': '1', 'coFlag': None, 'khaiValue': '177', 'coValue': '0.9', 'pm10Flag': None, 'no2Grade': '2', 'pm25Value24': '56', 'o3Flag': None, 'pm25Grade': '3', 'so2Flag': None, 'coGrade': '1', 'dataTime': '2023-12-30 02:00', 'pm10Grade': '2', 'o3Value': '0.002'}, {'pm25Grade1h': '3', 'pm10Value24': '66', 'so2Value': '0.003', 'pm10Grade1h': '2', 'o3Grade': '1', 'pm10Value': '68', 'pm25Flag': None, 'khaiGrade': '3', 'pm25Value': '65', 'no2Flag': None, 'mangName': '도시대기', 'no2Value': '0.044', 'so2Grade': '1', 'coFlag': None, 'khaiValue': '174', 'coValue': '0.9', 'pm10Flag': None, 'no2Grade': '2', 'pm25Value24': '55', 'o3Flag': None, 'pm25Grade': '3', 'so2Flag': None, 'coGrade': '1', 'dataTime': '2023-12-30 01:00', 'pm10Grade': '2', 'o3Value': '0.002'}], 'pageNo': 1, 'numOfRows': 10}, 'header': {'resultMsg': 'NORMAL_CODE', 'resultCode': '00'}}}\n"]},{"output_type":"execute_result","data":{"text/plain":["{'pm25Grade1h': '4',\n"," 'pm10Value24': '65',\n"," 'so2Value': '0.003',\n"," 'pm10Grade1h': '3',\n"," 'o3Grade': '1',\n"," 'pm10Value': '94',\n"," 'pm25Flag': None,\n"," 'khaiGrade': None,\n"," 'pm25Value': '89',\n"," 'no2Flag': None,\n"," 'mangName': '도시대기',\n"," 'no2Value': '0.033',\n"," 'so2Grade': '1',\n"," 'coFlag': None,\n"," 'khaiValue': '-',\n"," 'coValue': '0.9',\n"," 'pm10Flag': None,\n"," 'no2Grade': '2',\n"," 'pm25Value24': '-',\n"," 'o3Flag': None,\n"," 'pm25Grade': None,\n"," 'so2Flag': None,\n"," 'coGrade': '1',\n"," 'dataTime': '2023-12-30 10:00',\n"," 'pm10Grade': '2',\n"," 'o3Value': '0.003'}"]},"metadata":{},"execution_count":32}],"source":["#req_url = \"http://openapi.airkorea.or.kr/openapi/services/rest/ArpltnInforInqireSvc/getMsrstnAcctoRltmMesureDnsty\"\n","req_url = 'http://apis.data.go.kr/B552584/ArpltnInforInqireSvc/getMsrstnAcctoRltmMesureDnsty'\n","\n","station_name = \"둔산동\" #도산대로\n","data_term = \"DAILY\"\n","num_of_rows = 10\n","page_no = 1\n","version = 1.3\n","output_type = \"json\"\n","\n","req_parameter = {\"serviceKey\": API_KEY_decode,\n","                 \"stationName\": station_name,\n","                 \"dataTerm\":data_term, \"ver\": version,\n","                 \"pageNo\": page_no, \"numOfRows\" : num_of_rows,\n","                 \"returnType\": output_type}\n","\n","dict_data = requests.get(req_url,  params = req_parameter).json()\n","print(dict_data)\n","dict_data['list'] = dict_data['response']['body']['items']\n","dict_data['list'][0]\n","# dict_data"]},{"cell_type":"markdown","metadata":{"id":"BrrHihXtzgCT"},"source":["**[15장: 527페이지]**"]},{"cell_type":"code","execution_count":33,"metadata":{"id":"6x-WymWqzgCT","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1703900544810,"user_tz":-540,"elapsed":326,"user":{"displayName":"이석창","userId":"12669722191103790079"}},"outputId":"f12fffee-906c-40e1-b2c7-00158d382155"},"outputs":[{"output_type":"stream","name":"stdout","text":["[측정소(둔산동)에서 측정된 대기 오염 상태]\n","- 측정 시간:2023-12-30 10:00\n","- [지수] 아황산가스:1, 일산화탄소:1, 오존:1, 이산화질소:2\n","- [등급] 미세 먼지:3, 초미세 먼지:4, 통합대기환경:None\n"]}],"source":["dataTime = dict_data['list'][0]['dataTime']\n","\n","so2Grade = dict_data['list'][0]['so2Grade']\n","coGrade = dict_data['list'][0]['coGrade']\n","o3Grade = dict_data['list'][0]['o3Grade']\n","no2Grade = dict_data['list'][0]['no2Grade']\n","\n","pm10Grade1h = dict_data['list'][0]['pm10Grade1h']\n","pm25Grade1h = dict_data['list'][0]['pm25Grade1h']\n","khaiGrade = dict_data['list'][0]['khaiGrade']\n","\n","print(\"[측정소({0})에서 측정된 대기 오염 상태]\".format(station_name))\n","print(\"- 측정 시간:{0}\".format(dataTime))\n","\n","print(\"- [지수] \", end='')\n","print(\"아황산가스:{0}, 일산화탄소:{1}, 오존:{2}, 이산화질소:{3}\".\n","      format(so2Grade, coGrade, o3Grade, no2Grade))\n","\n","print(\"- [등급] \", end='')\n","print(\"미세 먼지:{0}, 초미세 먼지:{1}, 통합대기환경:{2}\".\n","      format(pm10Grade1h, pm25Grade1h, khaiGrade))"]},{"cell_type":"markdown","metadata":{"id":"-RL5yVwmzgCU"},"source":["**[15장: 527 ~ 528페이지]**"]},{"cell_type":"code","execution_count":34,"metadata":{"id":"nMQ2zizEzgCU","colab":{"base_uri":"https://localhost:8080/","height":276},"executionInfo":{"status":"error","timestamp":1703900553311,"user_tz":-540,"elapsed":337,"user":{"displayName":"이석창","userId":"12669722191103790079"}},"outputId":"23633c2a-c38b-46f7-e0c8-d759bbe61b37"},"outputs":[{"output_type":"stream","name":"stdout","text":["[측정소(둔산동)에서 측정된 대기 오염 상태]\n","- 측정 시간:2023-12-30 10:00\n","- 아황산가스:좋음, 일산화탄소:좋음, 오존:좋음, 이산화질소:보통\n"]},{"output_type":"error","ename":"KeyError","evalue":"ignored","traceback":["\u001b[0;31m---------------------------------------------------------------------------\u001b[0m","\u001b[0;31mKeyError\u001b[0m                                  Traceback (most recent call last)","\u001b[0;32m<ipython-input-34-e17830243b21>\u001b[0m in \u001b[0;36m<cell line: 10>\u001b[0;34m()\u001b[0m\n\u001b[1;32m     10\u001b[0m print(\"- 미세 먼지:{0}, 초미세 먼지:{1}, 통합대기환경:{2}\".\n\u001b[1;32m     11\u001b[0m           format(gradeNum2Str[pm10Grade1h],gradeNum2Str[pm25Grade1h],\n\u001b[0;32m---> 12\u001b[0;31m                  gradeNum2Str[khaiGrade]))\n\u001b[0m","\u001b[0;31mKeyError\u001b[0m: None"]}],"source":["gradeNum2Str = {\"1\":\"좋음\", \"2\":\"보통\", \"3\":\"나쁨\", \"4\":\"매우나쁨\" }\n","\n","print(\"[측정소({0})에서 측정된 대기 오염 상태]\".format(station_name))\n","print(\"- 측정 시간:{0}\".format(dataTime))\n","\n","print(\"- 아황산가스:{0}, 일산화탄소:{1}, 오존:{2}, 이산화질소:{3}\".\n","          format(gradeNum2Str[so2Grade], gradeNum2Str[coGrade],\n","                 gradeNum2Str[o3Grade], gradeNum2Str[no2Grade]))\n","\n","print(\"- 미세 먼지:{0}, 초미세 먼지:{1}, 통합대기환경:{2}\".\n","          format(gradeNum2Str[pm10Grade1h],gradeNum2Str[pm25Grade1h],\n","                 gradeNum2Str[khaiGrade]))"]},{"cell_type":"markdown","metadata":{"collapsed":true,"id":"RjSG_dLSzgCU"},"source":["## 15.5 정리"]}],"metadata":{"anaconda-cloud":{},"kernelspec":{"display_name":"Python 3","language":"python","name":"python3"},"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.6.4"},"latex_envs":{"LaTeX_envs_menu_present":true,"autoclose":false,"autocomplete":true,"bibliofile":"biblio.bib","cite_by":"apalike","current_citInitial":1,"eqLabelWithNumbers":true,"eqNumInitial":1,"hotkeys":{"equation":"Ctrl-E","itemize":"Ctrl-I"},"labels_anchors":false,"latex_user_defs":false,"report_style_numbering":false,"user_envs_cfg":false},"nav_menu":{},"toc":{"nav_menu":{"height":"512px","width":"252px"},"number_sections":false,"sideBar":true,"skip_h1_title":false,"toc_cell":false,"toc_position":{"height":"545px","left":"0px","right":"1078px","top":"111px","width":"288px"},"toc_section_display":"block","toc_window_display":false},"toc_position":{"height":"556px","left":"0px","right":"1057px","top":"107px","width":"309px"},"colab":{"provenance":[]}},"nbformat":4,"nbformat_minor":0}